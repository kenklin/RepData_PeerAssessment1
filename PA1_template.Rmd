---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
1. The following code loads the data into the `activity` dataframe.
```{r}
library(dplyr, warn.conflicts=FALSE)
library(ggplot2)
library(scales)
activity <- read.csv("activity.csv")
```

2. Use `activity$interval` (hhmm) to create a `tod` variable (time on epoch day 1) which will be useful for interval displays.
```{r}
activity$tod <- ISOdate(year=0, month=1, day=1,
    hour=activity$interval %/% 100,
    min=activity$interval %% 100)
```


## What is mean total number of steps taken per day?
1. This histogram plots the frequency of total number of steps taken each day, which is calculated and stored in `stepsByDate`.  Per the instructions, missing values in `activity` are *ignored*.  Rather than using the default binwidth of `diff(range(stepsByDate$totsteps))/30` (705.1), a more natural `bwidth` of 500 is used.
```{r}
stepsByDate <- na.omit(activity) %>% group_by(date) %>% summarise(totsteps=sum(steps))
#bwidth <- diff(range(stepsByDate$totsteps)) / 30
bwidth <- 500
ggplot(data=stepsByDate, aes(x=totsteps)) +
    geom_histogram(binwidth=bwidth) +
    ggtitle("Frequency of Steps per Day") +
    xlab(paste0("steps/day (binwidth=", bwidth, ")"))
```

2. The (integer) mean and median total number of steps taken per day are calculated with this code:
```{r}
stepsMean <- as.integer(mean(stepsByDate$totsteps))
stepsMedian <- as.integer(median(stepsByDate$totsteps))
```
The mean is ``r stepsMean`` and the median is ``r stepsMedian``.


## What is the average daily activity pattern?
1. This time series plot has the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis).  Missing values in `activity` are ignored.
```{r}
stepsByTimeOfDay <- na.omit(activity) %>%
    group_by(tod, interval) %>%
    summarise(totsteps=mean(steps))
ggplot(data=stepsByTimeOfDay, aes(x=tod, y=totsteps)) +
    geom_line() +
    ggtitle("Steps vs. Time of Day") +
    xlab("Time of Day") +
    scale_x_datetime(labels = date_format("%H:%M")) +
    ylab("Steps")
```

2. The following code determines which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps.
```{r}
maxStepsIndex <- which.max(stepsByTimeOfDay$totsteps)
maxSteps <- as.integer(stepsByTimeOfDay[maxStepsIndex, "totsteps"])
maxStepsInterval <- stepsByTimeOfDay[maxStepsIndex, "interval"]
maxStepsTimeOfDay <- format(stepsByTimeOfDay[maxStepsIndex, "tod"], format="%H:%M")
```
The maximum number of steps (`r maxSteps`) occurs at time period ``r maxStepsInterval`` (`r maxStepsTimeOfDay`).


## Imputing missing values
1. The following calculates the total number of rows in `activity` containing NAs ...
```{r}
numNA <- sum(is.na(activity$step))
```
The number of NA rows is ``r numNA``.

## Are there differences in activity patterns between weekdays and weekends?
